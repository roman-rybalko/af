Была идея проверять DKIM в smtp по ч/б спискам.
Из RFC5451 выяснилось "At the time of publication of this memo, [AUTH], [DKIM], [DOMAINKEYS], [SENDERID], and [SPF] are
published DNS domain-level email authentication methods in common use", т.е. DKIM - это один из методов аутентификации.
DKIM работает после получения сообщения, по этому логичнее его перенести в mailproc, где есть фреймворк, на котором
реализуются контентные методы.

DKIM все-же требуется для подписывания сообщений, проходящих через систему (для устранения спорных моментов по претензиям).
smtp подписывает стандартные заголовки RFC4871 и X-AdvancedFiltering-Rating.
submission подписывает стандартные заголовки RFC4871 и заголовки X-AdvancedFiltering-Abuse (SUBMISSION-abuse).

***
При наличии дублирующихся заголовков DKIM подписывает начиная с нижних, но MUA (Thunderbird) показывает верхний. Всилу
этого злоумышленник может добавить лишний заголовок Subject со spam-сообщением и оно будет отображено в MUA.
Это-же можно сделать с любым другим заголовком.
Решение: опеделять дублирующихся заголовки (из подписываемых DKIM) в mailproc и блокировать сообщение как спам.
