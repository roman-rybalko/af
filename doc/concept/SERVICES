Сервисы
==================

Продукт реализуется посредством сервисов,
которые взаимодействуют между собой,
образуя иерархию зависимостей.


Аккаунты для сервисов
================================

Для каждого сервиса создается отдельный аккаунт с префиксом advancedfiltering_.
Префикс требуется для избежания конфликтов при обновлении операционной системы.
Пример: advancedfiltering_smtp, advancedfiltering_ldap.


Почтове адреса
==========================
root@advancedfiltering.net - для логов со всех серверов
postmaster@advancedfiltering.net
dnsmaster@advancedfiltering.net
webmaster@advancedfiltering.net

Admin Email - для организационных сообщений
Tech Email - для технических автогенерированных сообщений (только адреса в клиентских доменах, т.к. с этих адресов идут бэкапы и спам, иначе нарушаем SPF)


Почтовые адреса для сервисов
=======================================

mailproc@services.advancedfiltering.net
spamtrap@services.advancedfiltering.net
bounce@services.advancedfiltering.net
error@services.advancedfiltering.net

xxx@services.advancedfiltering.net

Аутентификация и авторизация между сервисами
============================================

Аутентификация (проверка подлинности) 2-мя методами:
1. TLS сертификаты
2. Kerberos

Авторизация (проверка прав доступа) исходя из учетных данных Kerberos.

Большинством приложений TLS не рассматривается как средство авторизации.
Хоть и имеется возможность настроить авторизацию
исходя из данных сертификата пользователя (exim tls_peerdn),
это выглядит неестественно (ошибка авторизации на стадии установления
соединения STARTTLS).
Не все приложения поддерживают авторизацию на основе TLS (openldap).

Исходя из выше изложенного принято решение
применять TLS для допуска в инфраструктуру
и применять Kerberos для разграничения доступа.

***

Выявилось, что Exim не поддерживает клиентский код аутентификации Kerberos
ни через cyrus_sasl ни через heimdal_gssapi.

Фактически, приложения с аутентификацией - это Exim и OpenLdap.
Exim может авторизовать по сертификату, для OpenLdap авторизация не нужна.

Решено отказаться от SASL/Kerberos.
Блокирование отдельного хоста выполняется внесением его в CRL.
Kerberos использовать только для SSH и NFS.
